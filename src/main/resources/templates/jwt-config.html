<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>JWT Configuration | NovaTech Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-50">

<!-- Navbar -->
<nav class="bg-gradient-to-r from-indigo-600 to-purple-600 text-white shadow-lg">
    <div class="container mx-auto px-6 py-4">
        <div class="flex justify-between items-center">
            <div>
                <h1 class="text-2xl font-bold">üîë JWT Configuration</h1>
                <p class="text-sm text-indigo-100">Configure JSON Web Token authentication</p>
            </div>
            <a href="/admin/dashboard" class="px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg transition">
                ‚Üê Back to Dashboard
            </a>
        </div>
    </div>
</nav>

<!-- Main Container -->
<div class="container mx-auto px-6 py-8 max-w-4xl">

    <!-- Flash Messages -->
    <div th:if="${success}" class="mb-6 p-4 bg-green-100 border-l-4 border-green-500 text-green-700 rounded">
        <span th:text="${success}"></span>
    </div>
    <div th:if="${error}" class="mb-6 p-4 bg-red-100 border-l-4 border-red-500 text-red-700 rounded">
        <span th:text="${error}"></span>
    </div>

    <!-- Configuration Form -->
    <div class="bg-white rounded-xl shadow-lg p-8">

        <form th:action="@{/admin/jwt-config/save}" method="post">

            <!-- Enable/Disable Toggle -->
            <div class="mb-8 p-6 bg-indigo-50 rounded-lg border-2 border-indigo-200">
                <div class="flex items-center justify-between">
                    <div>
                        <h3 class="text-lg font-bold text-gray-800">JWT Authentication Status</h3>
                        <p class="text-sm text-gray-600 mt-1">Enable or disable JWT authentication for your application</p>
                    </div>
                    <label class="relative inline-flex items-center cursor-pointer">
                        <input type="checkbox" name="enabled" class="sr-only peer"
                               th:checked="${ssoConfig.enabled}">
                        <div class="w-14 h-7 bg-gray-300 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-indigo-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[4px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-6 after:w-6 after:transition-all peer-checked:bg-indigo-600"></div>
                        <span class="ml-3 text-sm font-medium text-gray-900">
                            <span th:text="${ssoConfig.enabled} ? 'Enabled' : 'Disabled'">Disabled</span>
                        </span>
                    </label>
                </div>
            </div>

            <!-- Provider Name -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Provider Name
                    <span class="text-red-500">*</span>
                </label>
                <input type="text" name="providerName" required
                       th:value="${ssoConfig.providerName}"
                       placeholder="e.g., miniOrange JWT"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent">
                <p class="text-sm text-gray-500 mt-1">Friendly name for this JWT provider</p>
            </div>

            <!-- Client ID -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Client ID
                    <span class="text-red-500">*</span>
                </label>
                <input type="text" name="clientId" required
                       th:value="${ssoConfig.clientId}"
                       placeholder="PHenk6pi3ziNu93HCNjazODsm14gCdC4"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">OAuth Client ID from your JWT provider</p>
            </div>

            <!-- Client Secret -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Client Secret
                    <span class="text-red-500">*</span>
                </label>
                <input type="password" name="clientSecret" required
                       th:value="${ssoConfig.clientSecret}"
                       placeholder="rUHETxbsj2znTIbbb0gj8jYcmXTtddJK"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">OAuth Client Secret (keep this confidential)</p>
            </div>

            <!-- Authorization Endpoint -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Authorization Endpoint
                    <span class="text-red-500">*</span>
                </label>
                <input type="url" name="authorizationEndpoint" required
                       th:value="${ssoConfig.authorizationEndpoint}"
                       placeholder="https://csumairkhan.xecurify.com/moas/idp/jwtsso/379422"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">JWT authorization URL from your provider</p>
            </div>

            <!-- Redirect URI -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Redirect URI (Callback URL)
                    <span class="text-red-500">*</span>
                </label>
                <input type="url" name="redirectUri" required
                       th:value="${ssoConfig.redirectUri}"
                       placeholder="http://localhost:8080/sso/callback"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">Where users are redirected after authentication</p>
            </div>

            <!-- Domain -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Provider Domain
                </label>
                <input type="url" name="domain"
                       th:value="${ssoConfig.domain}"
                       placeholder="https://csumairkhan.xecurify.com"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">Base domain of your JWT provider (optional)</p>
            </div>

            <!-- Certificate Path -->
            <div class="mb-6">
                <label class="block text-gray-700 font-semibold mb-2">
                    Certificate Path
                    <span class="text-red-500">*</span>
                </label>
                <input type="text" name="certificatePath" required
                       th:value="${ssoConfig.certificatePath}"
                       placeholder="classpath:miniorange_jwt.cer"
                       class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent font-mono text-sm">
                <p class="text-sm text-gray-500 mt-1">Path to JWT verification certificate (e.g., RSA256 public key)</p>
            </div>

            <!-- Info Box -->
            <div class="mb-8 p-4 bg-blue-50 border-l-4 border-blue-500 rounded">
                <h4 class="font-bold text-blue-800 mb-2">üìù Configuration Notes:</h4>
                <ul class="text-sm text-blue-700 space-y-1">
                    <li>‚Ä¢ Ensure the certificate file exists in <code class="bg-blue-100 px-1 rounded">src/main/resources/</code></li>
                    <li>‚Ä¢ The redirect URI must match exactly what's configured in your JWT provider</li>
                    <li>‚Ä¢ Test the configuration before enabling it in production</li>
                </ul>
            </div>

            <!-- Submit Buttons -->
            <div class="flex gap-4">
                <a href="/admin/dashboard"
                   class="flex-1 px-6 py-3 bg-gray-300 text-gray-700 text-center rounded-lg hover:bg-gray-400 transition font-semibold">
                    Cancel
                </a>
                <button type="submit"
                        class="flex-1 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-semibold">
                    üíæ Save Configuration
                </button>
            </div>

        </form>

    </div>

</div>

</body>
</html>


//working-version